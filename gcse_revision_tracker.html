<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GCSE Revision Tracker</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        /* Onboarding Styles */
        .onboarding {
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            padding: 40px;
            margin-top: 40px;
            text-align: center;
        }

        .onboarding h1 {
            color: #4a5568;
            font-size: 2.5rem;
            margin-bottom: 10px;
            font-weight: 700;
        }

        .onboarding p {
            color: #718096;
            font-size: 1.1rem;
            margin-bottom: 40px;
        }

        .subject-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 40px;
        }

        .subject-card {
            background: #f7fafc;
            border: 2px solid #e2e8f0;
            border-radius: 12px;
            padding: 20px;
            transition: all 0.3s ease;
        }

        .subject-card:hover {
            border-color: #667eea;
            transform: translateY(-2px);
        }

        .subject-card.selected {
            border-color: #667eea;
            background: #edf2f7;
        }

        .subject-checkbox {
            display: flex;
            align-items: center;
            margin-bottom: 15px;
            cursor: pointer;
        }

        .subject-checkbox input[type="checkbox"] {
            width: 20px;
            height: 20px;
            margin-right: 10px;
            accent-color: #667eea;
        }

        .subject-checkbox label {
            font-weight: 600;
            font-size: 1.1rem;
            color: #4a5568;
            cursor: pointer;
        }

        .exam-board-select {
            width: 100%;
            padding: 10px;
            border: 2px solid #e2e8f0;
            border-radius: 8px;
            font-size: 1rem;
            background: white;
        }

        .exam-board-select:focus {
            outline: none;
            border-color: #667eea;
        }

        .continue-btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 15px 40px;
            border-radius: 50px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .continue-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(102, 126, 234, 0.3);
        }

        .continue-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }

        /* Dashboard Styles */
        .dashboard {
            display: none;
        }

        .dashboard.active {
            display: block;
        }

        .header {
            background: white;
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.05);
            display: flex;
            justify-content: between;
            align-items: center;
            flex-wrap: wrap;
            gap: 15px;
        }

        .header h1 {
            color: #4a5568;
            font-size: 1.8rem;
            font-weight: 700;
        }

        .settings-btn {
            background: #e2e8f0;
            border: none;
            padding: 8px 16px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 0.9rem;
            color: #4a5568;
        }

        .settings-btn:hover {
            background: #cbd5e0;
        }

        /* Tab Styles */
        .tabs-container {
            background: white;
            border-radius: 15px 15px 0 0;
            box-shadow: 0 4px 6px rgba(0,0,0,0.05);
            overflow-x: auto;
        }

        .tabs {
            display: flex;
            min-width: min-content;
        }

        .tab {
            padding: 15px 25px;
            background: #f7fafc;
            border: none;
            cursor: pointer;
            font-size: 1rem;
            font-weight: 500;
            color: #718096;
            border-bottom: 3px solid transparent;
            transition: all 0.3s ease;
            white-space: nowrap;
            border-radius: 10px 10px 0 0;
            margin-right: 2px;
        }

        .tab:hover {
            background: #edf2f7;
            color: #4a5568;
        }

        .tab.active {
            background: white;
            color: #667eea;
            border-bottom-color: #667eea;
        }

        /* Content Styles */
        .content {
            background: white;
            border-radius: 0 0 15px 15px;
            padding: 30px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.05);
        }

        .paper-section {
            margin-bottom: 40px;
        }

        .paper-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 15px 20px;
            border-radius: 10px;
            font-size: 1.2rem;
            font-weight: 600;
            margin-bottom: 20px;
        }

        .topic {
            margin-bottom: 25px;
            border-left: 4px solid #e2e8f0;
            padding-left: 20px;
        }

        .topic-title {
            font-size: 1.1rem;
            font-weight: 600;
            color: #4a5568;
            margin-bottom: 15px;
        }

        .subtopic {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 0;
            border-bottom: 1px solid #f1f5f9;
        }

        .subtopic:last-child {
            border-bottom: none;
        }

        .subtopic-text {
            flex: 1;
            color: #2d3748;
            font-size: 0.95rem;
            line-height: 1.4;
        }

        .rag-buttons {
            display: flex;
            gap: 8px;
            margin-left: 15px;
        }

        .rag-btn {
            width: 35px;
            height: 35px;
            border: 2px solid;
            border-radius: 50%;
            cursor: pointer;
            font-weight: bold;
            font-size: 0.9rem;
            transition: all 0.2s ease;
            background: white;
        }

        .rag-btn.red {
            border-color: #f56565;
            color: #f56565;
        }

        .rag-btn.red.selected {
            background: #f56565;
            color: white;
        }

        .rag-btn.amber {
            border-color: #ed8936;
            color: #ed8936;
        }

        .rag-btn.amber.selected {
            background: #ed8936;
            color: white;
        }

        .rag-btn.green {
            border-color: #48bb78;
            color: #48bb78;
        }

        .rag-btn.green.selected {
            background: #48bb78;
            color: white;
        }

        .rag-btn:hover {
            transform: scale(1.1);
        }

        /* Progress Stats */
        .progress-stats {
            background: #f7fafc;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 30px;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 15px;
        }

        .stat {
            text-align: center;
        }

        .stat-number {
            font-size: 1.5rem;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .stat-number.red { color: #f56565; }
        .stat-number.amber { color: #ed8936; }
        .stat-number.green { color: #48bb78; }

        .stat-label {
            font-size: 0.9rem;
            color: #718096;
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .container {
                padding: 15px;
            }

            .onboarding {
                padding: 30px 20px;
                margin-top: 20px;
            }

            .onboarding h1 {
                font-size: 2rem;
            }

            .subject-grid {
                grid-template-columns: 1fr;
            }

            .header {
                flex-direction: column;
                text-align: center;
            }

            .tabs {
                overflow-x: auto;
            }

            .content {
                padding: 20px;
            }

            .subtopic {
                flex-direction: column;
                align-items: flex-start;
                gap: 10px;
            }

            .rag-buttons {
                margin-left: 0;
            }

            .progress-stats {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        @media (max-width: 480px) {
            .rag-btn {
                width: 30px;
                height: 30px;
                font-size: 0.8rem;
            }

            .progress-stats {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Onboarding Screen -->
        <div id="onboarding" class="onboarding">
            <h1>Welcome to GCSE Revision Tracker</h1>
            <p>Select your subjects and exam boards to get started with tracking your revision progress</p>
            
            <div class="subject-grid" id="subjectGrid">
                <!-- Subject cards will be generated here -->
            </div>
            
            <button class="continue-btn" id="continueBtn" onclick="completeOnboarding()">Save Selections & Continue</button>
        </div>

        <!-- Dashboard -->
        <div id="dashboard" class="dashboard">
            <div class="header">
                <h1>GCSE Revision Tracker</h1>
                <button class="settings-btn" onclick="showOnboarding()">Edit Subjects</button>
            </div>

            <div class="tabs-container">
                <div class="tabs" id="tabs">
                    <!-- Tabs will be generated here -->
                </div>
            </div>

            <div class="content">
                <div id="progressStats" class="progress-stats">
                    <!-- Progress stats will be shown here -->
                </div>
                <div id="tabContent">
                    <!-- Tab content will be shown here -->
                </div>
            </div>
        </div>
    </div>

    <script>
        // Subject and exam board data with accurate specifications
        const subjects = {
            'Mathematics': {
                examBoards: ['AQA', 'Edexcel', 'OCR'],
                specifications: {
                    'AQA': {
                        'Paper 1 (Non-Calculator)': {
                            'Number': [
                                'Structure and calculation',
                                'Fractions, decimals and percentages',
                                'Indices and surds',
                                'Standard form'
                            ],
                            'Algebra': [
                                'Algebraic manipulation',
                                'Graphs of linear functions',
                                'Solving linear equations',
                                'Solving linear inequalities'
                            ],
                            'Ratio, proportion and rates of change': [
                                'Ratio',
                                'Fractions as operators',
                                'Percentage change',
                                'Compound measures'
                            ]
                        },
                        'Paper 2 (Calculator)': {
                            'Geometry and measures': [
                                'Properties of 2D shapes',
                                'Properties of 3D shapes',
                                'Transformations',
                                'Constructions and loci',
                                'Mensuration and calculation',
                                'Pythagoras\' theorem',
                                'Trigonometry'
                            ],
                            'Statistics': [
                                'Statistical measures',
                                'Tables and charts',
                                'Probability'
                            ]
                        },
                        'Paper 3 (Calculator)': {
                            'Advanced Number': [
                                'Prime factorisation',
                                'HCF and LCM',
                                'Recurring decimals',
                                'Upper and lower bounds'
                            ],
                            'Advanced Algebra': [
                                'Quadratic equations',
                                'Simultaneous equations',
                                'Inequalities on graphs',
                                'Quadratic graphs',
                                'Other graphs'
                            ],
                            'Advanced Geometry': [
                                'Circle theorems',
                                'Similarity and congruence',
                                'Vectors'
                            ]
                        }
                    },
                    'Edexcel': {
                        'Paper 1 (Non-Calculator)': {
                            'Number': [
                                'Integers and decimals',
                                'Fractions',
                                'Percentages',
                                'Ratio and proportion',
                                'Indices and standard form'
                            ],
                            'Algebra': [
                                'Expressions and formulae',
                                'Linear equations',
                                'Sequences',
                                'Straight line graphs'
                            ]
                        },
                        'Paper 2 (Calculator)': {
                            'Number and Algebra': [
                                'Calculations',
                                'Quadratic equations',
                                'Inequalities',
                                'Algebraic graphs'
                            ],
                            'Geometry and Measures': [
                                'Angle properties',
                                'Transformations',
                                'Constructions',
                                'Mensuration',
                                'Pythagoras and trigonometry'
                            ]
                        },
                        'Paper 3 (Calculator)': {
                            'Statistics and Probability': [
                                'Data collection',
                                'Data processing and presentation',
                                'Averages and spread',
                                'Probability'
                            ],
                            'Advanced Topics': [
                                'Functions',
                                'Circle geometry',
                                'Vectors'
                            ]
                        }
                    }
                }
            },
            'English Language': {
                examBoards: ['AQA', 'Edexcel', 'OCR'],
                specifications: {
                    'AQA': {
                        'Paper 1: Explorations in Creative Reading and Writing': {
                            'Reading': [
                                'Fiction text analysis',
                                'Language techniques',
                                'Structure analysis',
                                'Writer\'s methods and effects'
                            ],
                            'Writing': [
                                'Creative writing',
                                'Descriptive writing',
                                'Narrative writing',
                                'Vocabulary and sentence structure'
                            ]
                        },
                        'Paper 2: Writers\' Viewpoints and Perspectives': {
                            'Reading': [
                                'Non-fiction text analysis',
                                'Comparing writers\' perspectives',
                                'Language for effect',
                                'Evaluating texts'
                            ],
                            'Writing': [
                                'Transactional writing',
                                'Persuasive writing',
                                'Discursive writing',
                                'Argument and counter-argument'
                            ]
                        }
                    }
                }
            },
            'English Literature': {
                examBoards: ['AQA', 'Edexcel', 'OCR'],
                specifications: {
                    'AQA': {
                        'Paper 1: Shakespeare and the 19th-century novel': {
                            'Shakespeare': [
                                'Character analysis',
                                'Themes and ideas',
                                'Language and structure',
                                'Context and interpretation'
                            ],
                            '19th-century novel': [
                                'Plot and narrative',
                                'Character development',
                                'Setting and atmosphere',
                                'Social and historical context'
                            ]
                        },
                        'Paper 2: Modern texts and poetry': {
                            'Modern prose or drama': [
                                'Modern themes',
                                'Character relationships',
                                'Dramatic techniques',
                                'Social context'
                            ],
                            'Poetry anthology': [
                                'Poetic techniques',
                                'Comparison skills',
                                'Themes across poems',
                                'Historical and cultural context'
                            ]
                        }
                    }
                }
            },
            'Science (Combined)': {
                examBoards: ['AQA', 'Edexcel', 'OCR'],
                specifications: {
                    'AQA': {
                        'Biology Paper 1': {
                            'Cell biology': [
                                'Cell structure and organisation',
                                'Cell division',
                                'Transport in cells'
                            ],
                            'Organisation': [
                                'Digestive system',
                                'Circulatory system',
                                'Respiratory system'
                            ],
                            'Infection and response': [
                                'Communicable diseases',
                                'Immune system',
                                'Drug development'
                            ]
                        },
                        'Biology Paper 2': {
                            'Bioenergetics': [
                                'Photosynthesis',
                                'Respiration'
                            ],
                            'Homeostasis and response': [
                                'Nervous system',
                                'Endocrine system',
                                'Water and nitrogen balance'
                            ],
                            'Inheritance and evolution': [
                                'Reproduction',
                                'Genetics',
                                'Evolution'
                            ],
                            'Ecology': [
                                'Ecosystems',
                                'Material cycles',
                                'Biodiversity'
                            ]
                        },
                        'Chemistry Paper 1': {
                            'Atomic structure and periodic table': [
                                'Atoms and elements',
                                'Compounds and mixtures',
                                'Development of atomic model',
                                'Electronic structure'
                            ],
                            'Bonding and structure': [
                                'Chemical bonds',
                                'Structure and properties of matter',
                                'Bulk and surface properties'
                            ],
                            'Quantitative chemistry': [
                                'Conservation of mass',
                                'Relative formula mass',
                                'Moles and equations'
                            ]
                        },
                        'Chemistry Paper 2': {
                            'Chemical changes': [
                                'Reactivity of metals',
                                'Reactions of acids',
                                'Electrolysis'
                            ],
                            'Energy changes': [
                                'Exothermic and endothermic reactions',
                                'Reaction profiles'
                            ],
                            'Rate and extent of chemical change': [
                                'Rate of reaction',
                                'Reversible reactions and equilibrium'
                            ],
                            'Organic chemistry': [
                                'Carbon compounds',
                                'Fuels'
                            ],
                            'Chemical analysis': [
                                'Pure substances',
                                'Identification of gases'
                            ]
                        },
                        'Physics Paper 1': {
                            'Energy': [
                                'Energy stores and transfers',
                                'Conservation of energy',
                                'Energy resources'
                            ],
                            'Electricity': [
                                'Current and charge',
                                'Potential difference and resistance',
                                'Series and parallel circuits'
                            ],
                            'Particle model of matter': [
                                'Density',
                                'Internal energy',
                                'Particle motion in gases'
                            ]
                        },
                        'Physics Paper 2': {
                            'Atomic structure': [
                                'Atoms and isotopes',
                                'Radioactive decay',
                                'Nuclear fission and fusion'
                            ],
                            'Forces': [
                                'Scalar and vector quantities',
                                'Newton\'s laws',
                                'Momentum'
                            ],
                            'Waves': [
                                'Wave properties',
                                'Electromagnetic spectrum',
                                'Sound waves'
                            ]
                        }
                    }
                }
            },
            'Biology': {
                examBoards: ['AQA', 'Edexcel', 'OCR'],
                specifications: {
                    'AQA': {
                        'Paper 1': {
                            'Cell Biology': [
                                'Cell structure',
                                'Cell organisation',
                                'Infection and response'
                            ],
                            'Organisation': [
                                'Principles of organisation',
                                'Animal tissues, organs and organ systems',
                                'Plant tissues, organs and systems'
                            ]
                        },
                        'Paper 2': {
                            'Bioenergetics': [
                                'Photosynthesis',
                                'Respiration'
                            ],
                            'Homeostasis and response': [
                                'Homeostasis',
                                'The human nervous system',
                                'Hormonal coordination'
                            ],
                            'Inheritance, variation and evolution': [
                                'Reproduction',
                                'Genetics',
                                'Evolution'
                            ],
                            'Ecology': [
                                'Adaptations, interdependence and competition',
                                'Organisation of an ecosystem',
                                'Biodiversity and the effect of human interaction'
                            ]
                        }
                    }
                }
            },
            'Chemistry': {
                examBoards: ['AQA', 'Edexcel', 'OCR'],
                specifications: {
                    'AQA': {
                        'Paper 1': {
                            'Atomic structure and the periodic table': [
                                'A simple model of the atom',
                                'Relative electrical charges',
                                'Size and mass of atoms',
                                'Relative atomic mass',
                                'Electronic structure'
                            ],
                            'Bonding, structure, and the properties of matter': [
                                'Chemical bonds',
                                'How bonding and structure are related to properties',
                                'Structure and bonding of carbon'
                            ],
                            'Quantitative chemistry': [
                                'Chemical amounts',
                                'Use of amount of substance in relation to masses of pure substances',
                                'Yield and atom economy of chemical reactions'
                            ],
                            'Chemical changes': [
                                'Reactivity of metals',
                                'Reactions of acids',
                                'Electrolysis'
                            ],
                            'Energy changes': [
                                'Exothermic and endothermic reactions',
                                'Reaction profiles',
                                'Bond energy calculations'
                            ]
                        },
                        'Paper 2': {
                            'The rate and extent of chemical change': [
                                'Rate of reaction',
                                'Reversible reactions and dynamic equilibrium'
                            ],
                            'Organic chemistry': [
                                'Carbon compounds as fuels and feedstock',
                                'Reactions of alkenes and alcohols',
                                'Synthetic and naturally occurring polymers'
                            ],
                            'Chemical analysis': [
                                'Purity, formulations and chromatography',
                                'Identification of common gases',
                                'Identification of ions by chemical and spectroscopic means'
                            ],
                            'Chemistry of the atmosphere': [
                                'The composition and evolution of the Earth\'s atmosphere',
                                'Carbon dioxide and methane as greenhouse gases',
                                'Common atmospheric pollutants and their sources'
                            ],
                            'Using resources': [
                                'Using the Earth\'s resources and obtaining potable water',
                                'Life cycle assessment and recycling',
                                'Using materials'
                            ]
                        }
                    }
                }
            },
            'Physics': {
                examBoards: ['AQA', 'Edexcel', 'OCR'],
                specifications: {
                    'AQA': {
                        'Paper 1': {
                            'Energy': [
                                'Energy changes in a system',
                                'Conservation and dissipation of energy',
                                'National and global energy resources'
                            ],
                            'Electricity': [
                                'Current, potential difference and resistance',
                                'Series and parallel circuits',
                                'Domestic uses and safety',
                                'Energy transfers'
                            ],
                            'Particle model of matter': [
                                'Changes of state and the particle model',
                                'Internal energy and energy transfers',
                                'Particle model and pressure'
                            ],
                            'Atomic structure': [
                                'Atoms and isotopes',
                                'Atoms and nuclear radiation',
                                'Hazards and uses of radioactive emissions',
                                'Nuclear fission and fusion'
                            ]
                        },
                        'Paper 2': {
                            'Forces': [
                                'Forces and their interactions',
                                'Work done and energy transfer',
                                'Forces and elasticity',
                                'Moments, levers and gears',
                                'Pressure and pressure differences in fluids',
                                'Forces and motion',
                                'Momentum'
                            ],
                            'Waves': [
                                'Transverse and longitudinal waves',
                                'Properties of waves',
                                'Reflection of waves',
                                'Sound waves',
                                'Electromagnetic waves',
                                'Lenses'
                            ],
                            'Magnetism and electromagnetism': [
                                'Permanent and induced magnetism',
                                'Magnetic fields',
                                'The motor effect',
                                'Induced potential difference',
                                'Loudspeakers and microphones'
                            ]
                        }
                    }
                }
            },
            'History': {
                examBoards: ['AQA', 'Edexcel', 'OCR'],
                specifications: {
                    'AQA': {
                        'Paper 1: Understanding the Modern World': {
                            'Period Study': [
                                'America, 1920-1973: Opportunity and inequality',
                                'Germany, 1890-1945: Democracy and dictatorship',
                                'Russia, 1894-1945: Tsardom and communism'
                            ],
                            'Wider World Depth Study': [
                                'Conflict and tension in Asia, 1950-1975',
                                'Conflict and tension between East and West, 1945-1972',
                                'Conflict and tension in the Gulf and Afghanistan, 1990-2009'
                            ]
                        },
                        'Paper 2: Shaping the Nation': {
                            'Thematic Study': [
                                'Britain: Health and the people: c1000 to the present day',
                                'Britain: Power and the people: c1170 to the present day',
                                'Britain: Migration, empires and the people: c790 to the present day'
                            ],
                            'British Depth Study': [
                                'Norman England, c1066-c1100',
                                'Medieval England: the reign of Edward I, 1272-1307',
                                'Elizabethan England, c1568-1603'
                            ]
                        }
                    }
                }
            },
            'Geography': {
                examBoards: ['AQA', 'Edexcel', 'OCR'],
                specifications: {
                    'AQA': {
                        'Paper 1: Living with the physical environment': {
                            'The challenge of natural hazards': [
                                'Natural hazards',
                                'Tectonic hazards',
                                'Weather hazards',
                                'Climate change'
                            ],
                            'The living world': [
                                'Ecosystems',
                                'Tropical rainforests',
                                'Hot deserts',
                                'Cold environments'
                            ],
                            'Physical landscapes in the UK': [
                                'UK physical landscapes',
                                'Coastal landscapes',
                                'River landscapes',
                                'Glacial landscapes'
                            ]
                        },
                        'Paper 2: Challenges in the human environment': {
                            'Urban issues and challenges': [
                                'The challenge of urbanisation',
                                'Urban change in the UK',
                                'Sustainable urban development'
                            ],
                            'The changing economic world': [
                                'The development gap',
                                'Reducing the development gap',
                                'Economic change in the UK'
                            ],
                            'The challenge of resource management': [
                                'Resource management',
                                'Food security',
                                'Water security',
                                'Energy security'
                            ]
                        },
                        'Paper 3: Geographical applications': {
                            'Issue evaluation': [
                                'Fieldwork',
                                'Problem solving',
                                'Decision making'
                            ],
                            'Fieldwork': [
                                'Physical geography fieldwork',
                                'Human geography fieldwork'
                            ]
                        }
                    }
                }
            }
        };

        // State management
        let selectedSubjects = [];
        let currentActiveTab = '';
        let ragStatus = {};

        // Initialize app
        function init() {
            loadSavedData();
            generateSubjectGrid();
            
            if (selectedSubjects.length > 0) {
                showDashboard();
            } else {
                showOnboarding();
            }
        }

        function loadSavedData() {
            const saved = JSON.parse(localStorage.getItem('gcseTracker') || '{}');
            selectedSubjects = saved.selectedSubjects || [];
            ragStatus = saved.ragStatus || {};
        }

        function saveData() {
            localStorage.setItem('gcseTracker', JSON.stringify({
                selectedSubjects: selectedSubjects,
                ragStatus: ragStatus
            }));
        }

        function generateSubjectGrid() {
            const grid = document.getElementById('subjectGrid');
            grid.innerHTML = '';

            Object.keys(subjects).forEach(subject => {
                const card = document.createElement('div');
                card.className = 'subject-card';
                
                const isSelected = selectedSubjects.some(s => s.subject === subject);
                if (isSelected) card.classList.add('selected');

                const selectedBoard = selectedSubjects.find(s => s.subject === subject)?.examBoard || subjects[subject].examBoards[0];

                card.innerHTML = `
                    <div class="subject-checkbox">
                        <input type="checkbox" id="${subject}" ${isSelected ? 'checked' : ''} 
                               onchange="toggleSubject('${subject}')">
                        <label for="${subject}">${subject}</label>
                    </div>
                    <select class="exam-board-select" id="board-${subject}" 
                            onchange="updateExamBoard('${subject}', this.value)">
                        ${subjects[subject].examBoards.map(board => 
                            `<option value="${board}" ${board === selectedBoard ? 'selected' : ''}>${board}</option>`
                        ).join('')}
                    </select>
                `;

                grid.appendChild(card);
            });

            updateContinueButton();
        }

        function toggleSubject(subject) {
            const checkbox = document.getElementById(subject);
            const card = checkbox.closest('.subject-card');
            const boardSelect = document.getElementById(`board-${subject}`);

            if (checkbox.checked) {
                card.classList.add('selected');
                const examBoard = boardSelect.value;
                if (!selectedSubjects.some(s => s.subject === subject)) {
                    selectedSubjects.push({ subject, examBoard });
                }
            } else {
                card.classList.remove('selected');
                selectedSubjects = selectedSubjects.filter(s => s.subject !== subject);
                // Remove RAG status for this subject
                delete ragStatus[subject];
            }

            updateContinueButton();
            saveData();
        }

        function updateExamBoard(subject, examBoard) {
            const subjectIndex = selectedSubjects.findIndex(s => s.subject === subject);
            if (subjectIndex !== -1) {
                selectedSubjects[subjectIndex].examBoard = examBoard;
                // Clear RAG status when exam board changes
                delete ragStatus[subject];
                saveData();
            }
        }

        function updateContinueButton() {
            const btn = document.getElementById('continueBtn');
            btn.disabled = selectedSubjects.length === 0;
        }

        function completeOnboarding() {
            if (selectedSubjects.length === 0) return;
            
            saveData();
            showDashboard();
        }

        function showOnboarding() {
            document.getElementById('onboarding').style.display = 'block';
            document.getElementById('dashboard').classList.remove('active');
            generateSubjectGrid();
        }

        function showDashboard() {
            document.getElementById('onboarding').style.display = 'none';
            document.getElementById('dashboard').classList.add('active');
            generateTabs();
            if (selectedSubjects.length > 0) {
                showTab(selectedSubjects[0].subject);
            }
        }

        function generateTabs() {
            const tabsContainer = document.getElementById('tabs');
            tabsContainer.innerHTML = '';

            selectedSubjects.forEach(({ subject }) => {
                const tab = document.createElement('button');
                tab.className = 'tab';
                tab.textContent = subject;
                tab.onclick = () => showTab(subject);
                tabsContainer.appendChild(tab);
            });
        }

        function showTab(subject) {
            currentActiveTab = subject;
            
            // Update active tab styling
            document.querySelectorAll('.tab').forEach(tab => {
                tab.classList.remove('active');
                if (tab.textContent === subject) {
                    tab.classList.add('active');
                }
            });

            // Show content for this subject
            const subjectData = selectedSubjects.find(s => s.subject === subject);
            if (subjectData) {
                displaySubjectContent(subjectData);
                updateProgressStats(subject);
            }
        }

        function displaySubjectContent({ subject, examBoard }) {
            const content = document.getElementById('tabContent');
            const spec = subjects[subject]?.specifications?.[examBoard];

            if (!spec) {
                content.innerHTML = `
                    <div style="text-align: center; padding: 40px; color: #718096;">
                        <h3>Specification not available</h3>
                        <p>The specification for ${subject} (${examBoard}) is not yet available.</p>
                    </div>
                `;
                return;
            }

            let html = '';

            Object.entries(spec).forEach(([paper, topics]) => {
                html += `<div class="paper-section">
                    <div class="paper-header">${paper}</div>`;

                Object.entries(topics).forEach(([topic, subtopics]) => {
                    html += `<div class="topic">
                        <div class="topic-title">${topic}</div>`;

                    subtopics.forEach(subtopic => {
                        const subtopicKey = `${subject}-${examBoard}-${paper}-${topic}-${subtopic}`;
                        const currentRag = ragStatus[subtopicKey] || '';

                        html += `
                            <div class="subtopic">
                                <div class="subtopic-text">${subtopic}</div>
                                <div class="rag-buttons">
                                    <button class="rag-btn red ${currentRag === 'red' ? 'selected' : ''}" 
                                            onclick="setRagStatus('${subtopicKey}', 'red')">R</button>
                                    <button class="rag-btn amber ${currentRag === 'amber' ? 'selected' : ''}" 
                                            onclick="setRagStatus('${subtopicKey}', 'amber')">A</button>
                                    <button class="rag-btn green ${currentRag === 'green' ? 'selected' : ''}" 
                                            onclick="setRagStatus('${subtopicKey}', 'green')">G</button>
                                </div>
                            </div>
                        `;
                    });

                    html += '</div>';
                });

                html += '</div>';
            });

            content.innerHTML = html;
        }

        function setRagStatus(subtopicKey, status) {
            // Toggle off if same status is clicked
            if (ragStatus[subtopicKey] === status) {
                delete ragStatus[subtopicKey];
            } else {
                ragStatus[subtopicKey] = status;
            }

            saveData();
            
            // Update button styling
            const buttons = document.querySelectorAll(`[onclick*="${subtopicKey}"]`);
            buttons.forEach(btn => btn.classList.remove('selected'));
            
            if (ragStatus[subtopicKey]) {
                const selectedBtn = document.querySelector(`[onclick*="${subtopicKey}"][onclick*="${ragStatus[subtopicKey]}"]`);
                if (selectedBtn) selectedBtn.classList.add('selected');
            }

            updateProgressStats(currentActiveTab);
        }

        function updateProgressStats(subject) {
            const statsContainer = document.getElementById('progressStats');
            const subjectData = selectedSubjects.find(s => s.subject === subject);
            
            if (!subjectData) return;

            const spec = subjects[subject]?.specifications?.[subjectData.examBoard];
            if (!spec) return;

            let totalSubtopics = 0;
            let redCount = 0;
            let amberCount = 0;
            let greenCount = 0;

            // Count all subtopics and their RAG status
            Object.entries(spec).forEach(([paper, topics]) => {
                Object.entries(topics).forEach(([topic, subtopics]) => {
                    subtopics.forEach(subtopic => {
                        totalSubtopics++;
                        const subtopicKey = `${subject}-${subjectData.examBoard}-${paper}-${topic}-${subtopic}`;
                        const status = ragStatus[subtopicKey];
                        
                        if (status === 'red') redCount++;
                        else if (status === 'amber') amberCount++;
                        else if (status === 'green') greenCount++;
                    });
                });
            });

            const notAssessed = totalSubtopics - redCount - amberCount - greenCount;

            statsContainer.innerHTML = `
                <div class="stat">
                    <div class="stat-number red">${redCount}</div>
                    <div class="stat-label">Need Help</div>
                </div>
                <div class="stat">
                    <div class="stat-number amber">${amberCount}</div>
                    <div class="stat-label">Getting There</div>
                </div>
                <div class="stat">
                    <div class="stat-number green">${greenCount}</div>
                    <div class="stat-label">Confident</div>
                </div>
                <div class="stat">
                    <div class="stat-number" style="color: #a0aec0;">${notAssessed}</div>
                    <div class="stat-label">Not Assessed</div>
                </div>
            `;
        }

        // Initialize the app when page loads
        init();
    </script>
</body>
</html>